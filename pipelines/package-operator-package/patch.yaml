---
- op: add
  path: /spec/description
  value: |
    Given a git repository, a reference (as in, tag or commit) and a path within the repository this pipeline will create a package-operator package.

    The process of how a pko package is defined and packaged is documented [here](https://package-operator.run/docs/guides/packaging-an-application/). This task expects the package definition, will build it using `kubectl-package` and push the created package to the given OCI registry destination.
- op: replace
  path: /metadata/name
  value: package-operator-package
- op: replace
  path: /spec/tasks/3/taskRef/name
  value: package-operator-package
- op: add
  path: /spec/tasks/3/params
  value:
  - name: SRC_PATH
    value: $(params.path-context)
  - name: DST_URL
    value: $(params.output-image)
- op: replace
  path: /spec/tasks/3/workspaces
  value:
  - name: package
    workspace: workspace
- op: remove
  path: /spec/params/4  # dockerfile
- op: remove
  path: /spec/tasks/16  # push-dockerfile
